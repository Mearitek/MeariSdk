<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<title>觅睿科技iOS SDK接入指南</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1><center> 目录 </center></h1>

<ul class="toc">
<li>
<a href="#toc_0">1. 功能概述</a>
</li>
<li>
<a href="#toc_1">2. 集成准备</a>
</li>
<li>
<a href="#toc_2">3. 集成SDK</a>
<ul>
<li>
<a href="#toc_3">3.1 集成准备</a>
<ul>
<li>
<a href="#toc_4">(1) 引入sdk包</a>
</li>
<li>
<a href="#toc_5">(2) 环境配置</a>
</li>
</ul>
</li>
<li>
<a href="#toc_6">3.2 集成SDK功能</a>
<ul>
<li>
<a href="#toc_7">(1) Application中初始化sdk配置</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_8">4. 用户管理</a>
<ul>
<li>
<a href="#toc_9">4.1 用户uid登录体系</a>
<ul>
<li>
<a href="#toc_10">(1) 重定向</a>
</li>
<li>
<a href="#toc_11">(2) 用户uid登录</a>
</li>
<li>
<a href="#toc_12">(3)  用户登出</a>
</li>
</ul>
</li>
<li>
<a href="#toc_13">4.2 普通用户体系管理</a>
<ul>
<li>
<a href="#toc_14">(1) 重定向</a>
</li>
<li>
<a href="#toc_15">(2) 注册账号</a>
</li>
<li>
<a href="#toc_16">(3) 账号登陆</a>
</li>
<li>
<a href="#toc_17">(4) 找回密码</a>
</li>
<li>
<a href="#toc_18">(5) 修改密码</a>
</li>
<li>
<a href="#toc_19">(6) 注册消息推送</a>
</li>
<li>
<a href="#toc_20">(7) 用户登出</a>
</li>
</ul>
</li>
<li>
<a href="#toc_21">4.3 用户上传头像</a>
</li>
<li>
<a href="#toc_22">4.4 修改昵称</a>
</li>
<li>
<a href="#toc_23">4.5 数据模型</a>
</li>
</ul>
</li>
<li>
<a href="#toc_24">5.设备消息通知</a>
</li>
<li>
<a href="#toc_25">6.设备配网</a>
<ul>
<li>
<a href="#toc_26">6.1 smartwifi配网</a>
<ul>
<li>
<a href="#toc_27">(1) 获取Token <strong>修改</strong></a>
</li>
<li>
<a href="#toc_28">(2) 开始SmartWifi配网</a>
</li>
<li>
<a href="#toc_29">(3) 停止SmartWifi配网</a>
</li>
</ul>
</li>
<li>
<a href="#toc_30">6.2 热点模式 (AP配网)</a>
<ul>
<li>
<a href="#toc_31">(1) 获取Token</a>
</li>
<li>
<a href="#toc_32">(2) AP配网</a>
</li>
</ul>
</li>
<li>
<a href="#toc_33">6.3 二维码配网</a>
<ul>
<li>
<a href="#toc_34">(1) 获取Token</a>
</li>
<li>
<a href="#toc_35">(2) 二维码配网</a>
</li>
</ul>
</li>
<li>
<a href="#toc_36">6.4 搜索设备</a>
<ul>
<li>
<a href="#toc_37">(1) smartwifi配网和ap配网搜索设备</a>
</li>
<li>
<a href="#toc_38">(2) 二维码配网搜索设备</a>
</li>
<li>
<a href="#toc_39">(3)  设备添加</a>
<ul>
<li>
<a href="#toc_40">&lt;1&gt; 添加摄像机</a>
</li>
<li>
<a href="#toc_41">&lt;2&gt; 添加网络存储器</a>
</li>
</ul>
</li>
<li>
<a href="#toc_42">(4) 停止搜索</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_43">7 NVR绑定设备</a>
<ul>
<li>
<a href="#toc_44">7.1 搜索设备</a>
</li>
<li>
<a href="#toc_45">7.2 绑定设备</a>
</li>
<li>
<a href="#toc_46">7.3 结束绑定设备</a>
</li>
<li>
<a href="#toc_47">7.4 获取NVR绑定的设备</a>
</li>
<li>
<a href="#toc_48">7.5 从NVR解绑设备</a>
</li>
</ul>
</li>
<li>
<a href="#toc_49">8.设备信息获取</a>
<ul>
<li>
<a href="#toc_50">8.1 获取设备列类</a>
</li>
<li>
<a href="#toc_51">8.2 设备信息</a>
</li>
<li>
<a href="#toc_52">8.3 删除设备</a>
</li>
<li>
<a href="#toc_53">8.4 设备昵称修改</a>
</li>
<li>
<a href="#toc_54">8.5 单个设备某天报警时间点获取</a>
</li>
<li>
<a href="#toc_55">8.6 查询设备是否有新版本</a>
</li>
<li>
<a href="#toc_56">8.7 查询设备在线状态</a>
</li>
<li>
<a href="#toc_57">8.8 查询音乐列表</a>
</li>
<li>
<a href="#toc_58">8.9 生成配网二维码</a>
</li>
<li>
<a href="#toc_59">8.10 远程唤醒门铃</a>
</li>
<li>
<a href="#toc_60">8.11 上传门铃留言</a>
</li>
<li>
<a href="#toc_61">8.12 下载门铃留言</a>
</li>
<li>
<a href="#toc_62">8.13 删除门铃留言</a>
</li>
</ul>
</li>
<li>
<a href="#toc_63">9.设备控制</a>
<ul>
<li>
<a href="#toc_64">9.1 连接设备</a>
</li>
<li>
<a href="#toc_65">9.2 断开设备</a>
</li>
<li>
<a href="#toc_66">9.3 获取码率</a>
</li>
<li>
<a href="#toc_67">9.4 预览</a>
</li>
<li>
<a href="#toc_68">9.5 回放</a>
</li>
<li>
<a href="#toc_69">9.6 静音</a>
</li>
<li>
<a href="#toc_70">9.7 语音对讲</a>
<ul>
<li>
<a href="#toc_71">(1) 单向对讲</a>
</li>
<li>
<a href="#toc_72">(2) 双向对讲</a>
</li>
<li>
<a href="#toc_73">(3) 语音门铃对讲</a>
</li>
</ul>
</li>
<li>
<a href="#toc_74">9.8 截图</a>
</li>
<li>
<a href="#toc_75">9.9 录像</a>
</li>
<li>
<a href="#toc_76">9.10 云台控制</a>
</li>
<li>
<a href="#toc_77">9.11 镜像</a>
</li>
<li>
<a href="#toc_78">9.12 移动侦测报警</a>
</li>
<li>
<a href="#toc_79">9.13 存储 (SD卡)</a>
</li>
<li>
<a href="#toc_80">9.14 固件升级</a>
<ul>
<li>
<a href="#toc_81">(1) 在线升级</a>
</li>
<li>
<a href="#toc_82">(2) 计划升级</a>
</li>
</ul>
</li>
<li>
<a href="#toc_83">9.15 获取参数信息</a>
</li>
<li>
<a href="#toc_84">9.16 休眠模式</a>
</li>
<li>
<a href="#toc_85">9.17 温湿度</a>
</li>
<li>
<a href="#toc_86">9.18 音乐</a>
</li>
<li>
<a href="#toc_87">9.19 设备音量</a>
</li>
<li>
<a href="#toc_88">9.20 门铃音量</a>
<ul>
<li>
<a href="#toc_89">(1) 可视门铃</a>
</li>
<li>
<a href="#toc_90">(2) 语音门铃</a>
</li>
</ul>
</li>
<li>
<a href="#toc_91">9.21 铃铛设置</a>
<ul>
<li>
<a href="#toc_92">(1) 可视门铃</a>
</li>
<li>
<a href="#toc_93">(2) 语音门铃</a>
</li>
</ul>
</li>
<li>
<a href="#toc_94">9.22 留言设置</a>
</li>
<li>
<a href="#toc_95">9.23 人体侦测报警</a>
</li>
<li>
<a href="#toc_96">9.24 门铃低功耗</a>
</li>
<li>
<a href="#toc_97">9.25 门铃电池锁</a>
</li>
<li>
<a href="#toc_98">9.26 留言</a>
<ul>
<li>
<a href="#toc_99">(1) 主人留言</a>
</li>
<li>
<a href="#toc_100">(2) 客人留言</a>
</li>
</ul>
</li>
<li>
<a href="#toc_101">9.27 设备播放留言</a>
</li>
<li>
<a href="#toc_102">9.28 灯具摄像机设置</a>
<ul>
<li>
<a href="#toc_103">(1) 开关灯</a>
</li>
<li>
<a href="#toc_104">(2) 报警器开关</a>
</li>
<li>
<a href="#toc_105">(3) 按时间段开灯</a>
</li>
<li>
<a href="#toc_106">(4) 按报警事件开关灯</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_107">10.共享设备</a>
<ul>
<li>
<a href="#toc_108">10.1 好友管理</a>
<ul>
<li>
<a href="#toc_109">(1) 添加好友</a>
</li>
<li>
<a href="#toc_110">(2) 删除好友</a>
</li>
<li>
<a href="#toc_111">(3) 修改好友昵称</a>
</li>
<li>
<a href="#toc_112">(4) 获取好友列表</a>
</li>
</ul>
</li>
<li>
<a href="#toc_113">10.2 添加分享</a>
<ul>
<li>
<a href="#toc_114">(1) 分享单个设备</a>
</li>
<li>
<a href="#toc_115">(2) 取消单个设备分享</a>
</li>
<li>
<a href="#toc_116">(3) 请求分享某个设备</a>
</li>
</ul>
</li>
<li>
<a href="#toc_117">10.3 查询分享</a>
<ul>
<li>
<a href="#toc_118">(1) 查询设备被分享过的好友列表</a>
</li>
<li>
<a href="#toc_119">(2) 查询某个好友的被分享设备列表</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#toc_120">11.消息中心</a>
<ul>
<li>
<a href="#toc_121">11.1 获取所有设备是否有消息</a>
</li>
<li>
<a href="#toc_122">11.2 获取系统消息</a>
</li>
<li>
<a href="#toc_123">11.3 获取某个设备报警消息</a>
</li>
<li>
<a href="#toc_124">11.4 批量删除系统消息</a>
</li>
<li>
<a href="#toc_125">11.5 批量删除多个设备报警消息</a>
</li>
<li>
<a href="#toc_126">11.6 标记单个设备消息全部已读</a>
</li>
<li>
<a href="#toc_127">11.7 好友消息处理</a>
</li>
<li>
<a href="#toc_128">11.8 设备消息处理</a>
</li>
</ul>
</li>
</ul>


<p><center></p>

<hr>

<table>
<thead>
<tr>
<th>版本号</th>
<th>制定团队</th>
<th>更新日期</th>
<th>备注</th>
</tr>
</thead>

<tbody>
<tr>
<td>2.0.1</td>
<td>觅睿技术团队</td>
<td>2019.11.04</td>
<td>预览回放修改</td>
</tr>
</tbody>
</table>

<p></center></p>

<h1 id="toc_0">1. 功能概述</h1>

<p>觅睿科技APP SDK提供了与硬件设备、觅睿云通讯的接口封装，加速应用开发过程，主要包括以下功能：</p>

<ul>
<li>硬件设备相关 (配网、控制、状态上报、固件升级、预览回放等功能) </li>
<li>账号体系 (手机号、邮箱的注册、登录、重置密码等通用账号功能) </li>
<li>设备共享</li>
<li>好友管理</li>
<li>消息中心</li>
<li>觅睿云HTTPS API接口封装 (参见觅睿云api调用) </li>
</ul>

<h1 id="toc_1">2. 集成准备</h1>

<p><strong>准备App Key和App Secert</strong></p>

<p>觅睿科技云平台提供App ID和App Secert，用于用户接入SDK快速接入摄像机设备</p>

<h1 id="toc_2">3. 集成SDK</h1>

<h2 id="toc_3">3.1 集成准备</h2>

<h3 id="toc_4">(1) 引入sdk包</h3>

<div><pre><code class="language-none">将下载好的MeariKit.framework拖到工程中</code></pre></div>

<h3 id="toc_5">(2) 环境配置</h3>

<div><pre><code class="language-none">1. 将MeariKit.framework 添加到 target -&gt; General -&gt; Embedded Binaries
2. 禁用bitcode：在工程面板中，选中target -&gt; Build Settings -&gt; Build Options -&gt; Enable Bitcode -&gt; 设为 No
3. 添加支持c++的文件：将任意一个.m文件改为.mm文件，例如将AppDelegate.m 改为 AppDelegate.mm格式</code></pre></div>

<h2 id="toc_6">3.2 集成SDK功能</h2>

<div><pre><code class="language-none">所属：MeariSdk工具类</code></pre></div>

<h3 id="toc_7">(1) Application中初始化sdk配置</h3>

<div><pre><code class="language-none">【描述】
    主要用于初始化内部资源、通信服务等功能。
 
【函数调用】
    /**
    启动SDK

    @param appKey appKey
    @param secretKey secret
    */
    - (void)startWithAppKey:(NSString *)appKey secretKey:(NSString *)secretKey;
    
    /**
    设置调试打印级别
    
    @param logLevel 打印级别
    */
    - (void)setLogLevel:(MeariLogLevel)logLevel;
    
    
    /**
    配置服务器环境
    
    @param environment 预发或正式
    */
    - (void)configEnvironment:(MearEnvironment)environment;

【代码范例】
    //启动SDK
    [[MeariSDK sharedInstance] startWithAppKey:@&quot;appKey&quot; secretKey:@&quot;secretKey&quot;];
    
    //配置服务器环境：预发或正式，当前是开发版本，只支持预发环境上运行
    [[MeariSDK sharedInstance] configEnvironment:MearEnvironmentRelease];
    
    //设置调试log级别，会打印内部接口的输入输出信息，以便排查问题
    [[MeariSDK sharedInstance] setLogLevel:MeariLogLevelOff];
    </code></pre></div>

<h1 id="toc_8">4. 用户管理</h1>

<div><pre><code class="language-none">所属：MeariUser工具类</code></pre></div>

<div><pre><code class="language-none">觅睿科技SDK提供两种用户管理体系：普通用户体系、UID用户体系

普通用户体系：账号登录、注册、修改密码、找回密码、获取验证码
UID用户体系：uid登录 (最长64位) ，无需注册没有密码系统，请妥善保管</code></pre></div>

<h2 id="toc_9">4.1 用户uid登录体系</h2>

<div><pre><code class="language-none">觅睿科技提供uid登陆体系。如果客户自有用户体系，那么可以通过uid登陆体系，接入我们的sdk。</code></pre></div>

<h3 id="toc_10">(1) 重定向</h3>

<div><pre><code class="language-none">【描述】
Meari SDK 支持全球服务，当选择不同的国家时需要重置访问地址，根据登录时传入国家代号，访问对应的服务器
【函数调用】
//切换账号、修改国家时调用
- (void)resetRedirect;    </code></pre></div>

<h3 id="toc_11">(2) 用户uid登录</h3>

<div><pre><code class="language-none">【描述】
用户uid注册，uid要求唯一。

【函数调用】
/**
通过Uid登录

@param uid 用户ID，需要保证唯一性，&lt;=32位
@param countryCode 国家代号
@param phoneCode 国家区号
@param success 成功回调
@param failure 失败回调
*/
- (void)loginWithUid:(NSString *)uid countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode  success:(MeariSuccess)success  failure:(MeariFailure)failure

【代码范例】
//通过Uid登录
[[MeariUser sharedInstance] loginWithUid:@&quot;abcdefghijklmn&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; success:^{

} failure:^(NSError *error) {

}];
</code></pre></div>

<h3 id="toc_12">(3)  用户登出</h3>

<div><pre><code class="language-none">【描述】
登出同普通账号登出

【函数调用】
//登出账号
@param success 成功回调
@param failure 失败回调
- (void)logoutSuccess:(MeariSuccess)success failure:(MeariFailure)failure;


【代码范例】
//登出账号
[[MeariUser sharedInstance] logoutSuccess:^{

} failure:^(NSError *error) {

}];</code></pre></div>

<h2 id="toc_13">4.2 普通用户体系管理</h2>

<h3 id="toc_14">(1) 重定向</h3>

<div><pre><code class="language-none">【描述】
    Meari SDK 支持全球服务，当选择不同的国家时需要重置访问地址，根据登录时传入国家代号，访问对应的服务器
【函数调用】
    //切换账号、修改国家时调用
    - (void)resetRedirect;    </code></pre></div>

<h3 id="toc_15">(2) 注册账号</h3>

<div><pre><code class="language-none">【描述】
    注册账号前需要获取验证码
 
【函数调用】
    //获取验证码
    @param userAccount 用户账号：邮箱或手机
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param success 成功回调，返回验证码剩余有效时间，单位秒
    @param failure 失败回调
    - (void)getValidateCodeWithAccount:(NSString *)userAccount countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode success:(void(^)(NSInteger seconds))success failure:(MeariFailure)failure;

    //注册账号
    @param userAccount 用户账号：邮箱或手机号(仅限中国大陆地区)
    @param password 用户密码
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param verificationCode 验证码
    @param nickname 用户昵称，登录后可修改
    @param success 成功回调
    @param failure 失败回调
    - (void)registerAccount:(NSString *)userAccount password:(NSString *)password countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode verificationCode:(NSString *)verificationCode nickname:(NSString *)nickname success:(MeariSuccess)success failure:(MeariFailure)failure;
    
【代码范例】
    //获取账号的验证码
    [[MeariUser sharedInstance] getValidateCodeWithAccount:@&quot;john@163.com&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; success:^(NSInteger seconds) {
        //成功
    } failure:^(NSError *error) {
        //失败
    }];
    //注册账号
    [[MeariUser sharedInstance] registerAccount:@&quot;john@163.com&quot; password:@&quot;123456&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; verificationCode:@&quot;7234&quot; nickname:@&quot;coder man&quot; success:^{
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_16">(3) 账号登陆</h3>

<div><pre><code class="language-none">【描述】
    支持邮箱登录、手机(仅限中国大陆地区)登录
 
【函数调用】
    //登陆
    @param userAccount 用户账号：邮箱或手机
    @param password 用户密码
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param success 成功回调
    @param failure 失败回调
    - (void)loginAccount:(NSString *)userAccount password:(NSString *)password countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode success:(MeariSuccess)success failure:(MeariFailure)failure;
    
【代码范例】
    [[MeariUser sharedInstance] loginAccount:@&quot;john@163.com&quot; password:@&quot;123456&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; success:^{
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_17">(4) 找回密码</h3>

<div><pre><code class="language-none">- (void)resetPasswordWithAccount:(NSString *)userAccount password:(NSString *)password verificationCode:(NSString *)verificationCode success:(MeariSuccess)success failure:(MeariFailure)failure;</code></pre></div>

<div><pre><code class="language-none">【描述】
    找回密码前需要先获取验证码
 
【函数调用】
    //获取验证码
    @param userAccount 用户账号：邮箱或手机
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param success 成功回调，返回验证码剩余有效时间，单位秒
    @param failure 失败回调
    - (void)getValidateCodeWithAccount:(NSString *)userAccount countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode success:(void(^)(NSInteger seconds))success failure:(MeariFailure)failure;

    //找回密码
    @param userAccount 用户账号：邮箱或手机号(仅限中国大陆地区)
    @param password 新的密码
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param verificationCode 验证码
    @param success 成功回调
    @param failure 失败回调
    - (void)findPasswordWithAccount:(NSString *)userAccount password:(NSString *)password countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode verificationCode:(NSString *)verificationCode success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //获取账号的验证码
    [[MeariUser sharedInstance] getValidateCodeWithAccount:@&quot;john@163.com&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; success:^(NSInteger seconds) {
        //成功
    } failure:^(NSError *error) {
        //失败
    }];
    //找回密码
    [[MeariUser sharedInstance] findPasswordWithAccount:@&quot;john@163.com&quot; password:@&quot;123123&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; verificationCode:@&quot;6322&quot; success:^{
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_18">(5) 修改密码</h3>

<div><pre><code class="language-none">【描述】
    登录后修改密码，修改密码前需要先获取验证码

【函数调用】
    //获取验证码
    @param userAccount 用户账号：邮箱或手机
    @param countryCode 国家代号
    @param phoneCode 国家区号
    @param success 成功回调，返回验证码剩余有效时间，单位秒
    @param failure 失败回调
    - (void)getValidateCodeWithAccount:(NSString *)userAccount countryCode:(NSString *)countryCode phoneCode:(NSString *)phoneCode success:(void(^)(NSInteger seconds))success failure:(MeariFailure)failure;

    //修改密码
    @param userAccount 用户账号：邮箱或手机号(仅限中国大陆地区)
    @param password 用户密码
    @param verificationCode 验证码
    @param success 成功回调
    @param failure 势必啊回调
    - (void)changePasswordWithAccount:(NSString *)userAccount password:(NSString *)password verificationCode:(NSString *)verificationCode success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //获取账号的验证码
    [[MeariUser sharedInstance] getValidateCodeWithAccount:@&quot;john@163.com&quot; countryCode:@&quot;CN&quot; phoneCode:@&quot;86&quot; success:^(NSInteger seconds) {
        //成功
    } failure:^(NSError *error) {
        //失败
    }];
    //找回密码
    [[MeariUser sharedInstance] changePasswordWithAccount:@&quot;john@163.com&quot; password:@&quot;234567&quot; verificationCode:@&quot;8902&quot; success:^{
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_19">(6) 注册消息推送</h3>

<div><pre><code class="language-none">【描述】
    注册Meari消息推送
    在登录、注册、找回密码后调用，如果接口返回错误，间隔一段时间重新注册推送

【函数调用】
    @param deviceToken 手机token 
    @param success 成功回调
    @param failure 失败回调
    - (void)registerPushWithDeviceToken:(NSData *)deviceToken success:(MeariSuccess_Dictionary)success failure:(MeariFailure)failure;</code></pre></div>

<h3 id="toc_20">(7) 用户登出</h3>

<div><pre><code class="language-none">【描述】
    登出，退出账号

【函数调用】
    //登出账号
    @param success 成功回调
    @param failure 失败回调
    - (void)logoutSuccess:(MeariSuccess)success failure:(MeariFailure)failure;


【代码范例】
    //登出账号
    [[MeariUser sharedInstance] logoutSuccess:^{
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h2 id="toc_21">4.3 用户上传头像</h2>

<div><pre><code class="language-none">【描述】
    用户上传头像
 
【函数调用】
    /*
     @param image 图片
     @param success 成功回调，返回头像的url
     @param failure 失败回调
     */
    - (void)uploadUserAvatar:(UIImage *)image success:(MeariSuccess_Avatar)success failure:(MeariFailure)failure;
        
【代码范例】
    [[MeariUser sharedInstance] uploadUserAvatar:[UIImage imageWithData:self.imageData] success:^(NSString *avatarUrl) {

    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h2 id="toc_22">4.4 修改昵称</h2>

<div><pre><code class="language-none">【描述】
    修改用户昵称。
 
【函数调用】
    /*
    @param name 新的昵称，长度6-20位
    @param success 成功回调
    @param failure 失败回调
     */
    - (void)renameNickname:(NSString *)name  success:(MeariSuccess)success failure:(MeariFailure)failure;
        
【代码范例】
    [[MeariUser sharedInstance] renameNickname:newName success:^{
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h2 id="toc_23">4.5 数据模型</h2>

<p>用户相关的数据模型。</p>

<div><pre><code class="language-none">【MeariUserInfo】
@property (nonatomic, strong) NSString * avatarUrl;     //用户头像
@property (nonatomic, strong) NSString * nickName;      //用户昵称
@property (nonatomic, strong) NSString * userAccount;   //用户账号
@property (nonatomic, strong) NSString * userID;        //用户ID
@property (nonatomic, strong) NSString * userToken;     //用户session
@property (nonatomic, strong) NSString * loginTime;     //用户登录时间
@property (nonatomic, strong) NSString * pushAlias;     //用户推送别名，用于极光推送 (废弃) 
@property (nonatomic, strong) NSString * token;         //用户有效标识
@property (nonatomic, strong) NSString * secrect;       //用户有效标识
@property (nonatomic, strong) NSString * userKey;       //用户key
@property (nonatomic, strong) NSString * userName;      //用户名称
@property (nonatomic, strong) NSString * countryCode;   //注册国家代号
@property (nonatomic, strong) NSString * phoneCode;     //注册国家手机代号
@property (nonatomic, assign) BOOL notificationSound;   //消息推送是否有声音</code></pre></div>

<h1 id="toc_24">5.设备消息通知</h1>

<div><pre><code class="language-none">及时消息通知是MeariSDK及时通知App端当前用户和用户账户下设备的一些状态，以方便App端实现更好的用户体验

【通知类型】参见：MeariUser.h
    MeariDeviceOnlineNotification  (设备上线) 
    MeariDeviceOfflineNotification  (设备离线) 
    MeariDeviceCancelSharedNotification  (设备主人取消了分享) 
    MeariDeviceHasVisitorNotification    (可视门铃设备有访客按门铃) 
    MeariDeviceVoiceBellHasVisitorNotification  (语音门铃设备有访客按门铃)  
    MeariDeviceUnbundlingNotification   (设备已被解绑)
    MeariUserLoginInvalidNotification    (登录信息失效，需要重新登录) 
【使用】
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(userLoginInvalidNotification:) name:MeariUserLoginInvalidNotification object:nil];</code></pre></div>

<h1 id="toc_25">6.设备配网</h1>

<div><pre><code class="language-none">所属：MeariDevice工具类</code></pre></div>

<div><pre><code class="language-none">觅睿科技硬件模块支持三种配网模式：SmartWifi配网、热点模式 (AP模式) 、二维码配网模式。
二维码和SmartWifi操作较为简便，建议在配网失败后，再使用热点模式作为备选方案。其中二维码配网成功率较高。</code></pre></div>

<h2 id="toc_26">6.1 smartwifi配网</h2>

<div><pre><code class="language-none">配网之前需要先获取Token，然后再调用配网接口</code></pre></div>

<h3 id="toc_27">(1) 获取Token <strong>修改</strong></h3>

<div><pre><code class="language-none">【描述】
smart wifi配网需要提供所连wifi的名称和密码

【函数调用】
    /**
    获取配网token

    @param tokenType 不同配网模式对应不同的Token
    @param success 成功回调：
    token: 用于配网
    validTime: token有效时长，超过时长需要重新获取新的token
    @param failure 失败回调
    */
    - (void)getToken:(MeariDeviceTokenType)tokenType success:(MeariSuccess_Token)success failure:(MeariFailure)failure;
【代码范例】
    [[MeariUser sharedInstance] getTokenForType:MeariDeviceTokenTypeSmartWifi success:^(NSString *token, NSInteger validTime) {
        //Don&#39;t care about validTime, because this type of Token is long-lived
    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_28">(2) 开始SmartWifi配网</h3>

<div><pre><code class="language-none">【描述】
    smart wifi配网需要提供所连wifi的名称和密码
 
【函数调用】
    /**
     开始 smartwifi 配网
    
     @param wifiSSID wifi名称
     @param wifiPwd wifi密码：没有密码，传nil
     @param success 成功回调
     @param failure 失败回调
     */
    + (void)startMonitorWifiSSID:(NSString *)wifiSSID wifiPwd:(NSString *)wifiPwd success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;
        
【代码范例】
    [MeariDevice startMonitorWifiSSID:@&quot;wifi name&quot; wifiPwd:@&quot;12345678&quot; success:^{
        //成功的回调只会在停止的时候返回
    } failure:^(NSError *error){
        //异常的回调会直接返回
    }];</code></pre></div>

<h3 id="toc_29">(3) 停止SmartWifi配网</h3>

<div><pre><code class="language-none">    /**
    停止 smartwifi 配网
    */
    + (void)stopMonitor;</code></pre></div>

<h2 id="toc_30">6.2 热点模式 (AP配网)</h2>

<div><pre><code class="language-none">配网之前需要先获取Token，然后再调用配网接口</code></pre></div>

<h3 id="toc_31">(1) 获取Token</h3>

<div><pre><code class="language-none">【描述】
    获取AP配网所需要的Token

【函数调用】
    /**
    获取配网token

    @param tokenType 不同配网模式对应不同的Token
    @param success 成功回调：
    token: 用于配网
    validTime: token有效时长，超过时长需要重新获取新的token
    @param failure 失败回调
    */
    - (void)getTokenForType:(MeariDeviceTokenType)tokenType success:(MeariSuccess_Token)success failure:(MeariFailure)failure;
    
【代码范例】
    [[MeariUser sharedInstance] getTokenForType:MeariDeviceTokenTypeAP success:^(NSString *token, NSInteger validTime) {
        //不用关心validTime，这种模式下Token一直有效
    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_32">(2) AP配网</h3>

<div><pre><code class="language-none">【描述】
    ap配网需要提供所连wifi的名称和密码，且配网前需连接到设备的热点,(设备热点名称为:`STRN`加`下划线`加`sn号`如：STRN_056566188)
 
【函数调用】
    
    /**
     开始 ap 配网
    
     @param wifiSSID wifi名称
     @param wifiPwd wifi密码
     @param success 成功回调
     @param failure 失败回调
     */
    + (void)startAPConfigureWifiSSID:(NSString *)wifiSSID wifiPwd:(NSString *)wifiPwd success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

        
【代码范例】
    //开始smartwifi配网
    [MeariDevice startAPConfigureWifiSSID:@&quot;wifi name&quot; wifiPwd:@&quot;12345678&quot; success:^{

    } failure:^(NSString *error) {
    
    }];
    </code></pre></div>

<h2 id="toc_33">6.3 二维码配网</h2>

<div><pre><code class="language-none">配网之前需要先获取Token，然后再调用配网接口</code></pre></div>

<h3 id="toc_34">(1) 获取Token</h3>

<div><pre><code class="language-none">【描述】
    获取AP配网所需要的Token，注意此Token有过期时间

【函数调用】
    /**
    获取配网token

    @param tokenType 不同配网模式对应不同的Token
    @param success 成功回调：
    token: 用于配网
    validTime: token有效时长，超过时长需要重新获取新的token
    @param failure 失败回调
    */
    - (void)getTokenForType:(MeariDeviceTokenType)tokenType success:(MeariSuccess_Token)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getTokenForType:MeariDeviceTokenTypeQRCode success:^(NSString *token, NSInteger validTime) {
        //validTime为超时时间，超时的Token不能用于二维码配网，需要重新获取Token
    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_35">(2) 二维码配网</h3>

<div><pre><code class="language-none">【描述】
    将获取到的token和手机所在的WiFi和密码生成二维码图片，二维码图片推荐：284px的正方形图片
 
【函数调用】
    /**
     生成二维码
    
     @param ssid wifi名称
     @param password wifi密码
     @param token 二维码token
     @param size 二维码大小
     @return 二维码图片
     */
    - (UIImage *)createQRWithSSID:(NSString *)ssid pasword:(NSString *)password token:(NSString *)token size:(CGSize)size;
        
【代码范例】
    
    //生成二维码
    UIImage *image = [[MeariUser sharedInstance] createQRWithSSID:@&quot;wifi name&quot; pasword:@&quot;123456&quot; token:token size:CGSizeMake(100, 100)];</code></pre></div>

<h2 id="toc_36">6.4 搜索设备</h2>

<div><pre><code class="language-none">搜索时机：设备配网成功后，会蓝灯常亮，此时即可搜索到设备
搜索机制：搜索接口没有超时机制，直到调用停止接口，才会停止搜索
搜索模式：局域网搜索和云搜索</code></pre></div>

<h3 id="toc_37">(1) smartwifi配网和ap配网搜索设备</h3>

<div><pre><code class="language-none">【描述】
    IPC设备：设备配网成功蓝灯常亮后，才能搜索到设备，用于展示给用户进行添加操作
    NVR设备：被添加的NVR需要与手机在同一个网络下，才可以被搜索到
 
【函数调用】
    
    /**
     开始搜索：适用于smartwifi配网和ap配网
    
     @param success 成功回调：返回搜索到的设备
     @param failure 失败回调
     */
    + (void)startSearch:(MeariDeviceSucess_SearchDevice)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //开始搜索：适用于smartwifi配网和ap配网
     [MeariDevice startSearch:^(MeariDevice *device) {
        
    } failure:^(NSString *error) {
        
    }];</code></pre></div>

<h3 id="toc_38">(2) 二维码配网搜索设备</h3>

<div><pre><code class="language-none">【方法一：】

【描述】
    设备配网成功蓝灯常亮后，才能搜索到设备，用于展示给用户进行添加操作
    
    注意：搜索的Token需要与二维码配网获取Token保持一致，否则会搜索不到设备
    
【函数调用】
    /**
    开始搜索：仅适用于二维码配网

    @param token 二维码token 
    @param success 成功回调：返回搜索到的设备
    @param failure 失败回调
    */
    + (void)startSearchWithQRcodeToken:(NSString *)token success:(MeariDeviceSucess_SearchDevice)success failure:(MeariDeviceFailure)failure;

【方法二：】**去掉**
    
【描述】
    设备配网成功蓝灯常亮后，才能搜索到设备，用于展示给用户进行添加操作

    注意：搜索前需要先更新下Token,搜索的Token需要与二维码配网获取Token保持一致，否则会搜索不到设备

【函数调用】
    /**
    更新Token

    @param token 配网方式的token
    @param type  配网方式
    */
    + (void)updatetoken:(NSString *)token type:(MeariDeviceTokenType)type;
    
    /**
    开始搜索：搜索通用接口
    在使用此接口时要确保调用了updatetoken方法
    @param mode 配网方式
    @param success 成功回调：返回搜索到的设备
    @param failure 失败回调
    */
    + (void)startSearch:(MeariDeviceSearchMode)mode success:(MeariDeviceSucess_SearchDevice)success failure:(MeariDeviceFailure)failure;
    
【代码范例】
    [MeariDevice updatetoken:self.token type:MeariDeviceTokenTypeQRCode];
    [MeariDevice startSearch:MeariSearchModeCloud_QRCode success:^(MeariDevice *device) {
   
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_39">(3)  设备添加</h3>

<h4 id="toc_40"><1> 添加摄像机</h4>

<div><pre><code class="language-none">【描述】
    搜索到设备后，先进行查询设备状态查询，在没有被人添加的情况下，才可以进行添加设备操作

【适用】
    Type:
        MeariDeviceTypeIpc
    subType:
        All

【函数调用】
    //查询设备状态
    @param type 设备类型
    @param devices 要查询的设备：需使用调用设备接口，搜索出来的设备
    @param success 成功回调：返回设备列表
    @param failure 失败回调
    - (void)checkDeviceStatusWithDeviceType:(MeariDeviceType)type devices:(NSArray &lt;MeariDevice *&gt;*)devices success:(MeariSuccess_DeviceListForStatus)success failure:(MeariFailure)failure;

    //添加设备
    @param type 设备类型
    @param uuid 设备uuid
    @param sn 设备sn
    @param tp 设备tp
    @param success 成功回调
    @param failure 失败回调
    - (void)addDeviceWithDeviceType:(MeariDeviceType)type uuid:(NSString *)uuid sn:(NSString *)sn tp:(NSString *)tp success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //查询摄像机
    [[MeariUser sharedInstance] checkDeviceStatusWithDeviceType:MeariDeviceTypeIpc devices:deviceArray success:^(NSArray&lt;MeariDevice *&gt; *devices) {

    } failure:^(NSError *error) {

    }];

    //添加摄像机
    [[MeariUser sharedInstance] addDeviceWithDeviceType:MeariDeviceTypeIpc uuid:device.info.uuid sn:device.info.sn tp:device.info.tp success:^{

    } failure:^(NSError *error) {

    }];
</code></pre></div>

<h4 id="toc_41"><2> 添加网络存储器</h4>

<div><pre><code class="language-none">【描述】
    搜索到NVR设备后，先进行查询设备状态查询，在没有被人添加的情况下，才可以进行添加设备操作
    
【适用】
    Type:
        MeariDeviceTypeNVR
        
【函数调用】
    //查询设备状态
    @param type 设备类型
    @param devices 要查询的设备：需使用调用设备接口，搜索出来的设备
    @param success 成功回调：返回设备列表
    @param failure 失败回调
    - (void)checkDeviceStatusWithDeviceType:(MeariDeviceType)type devices:(NSArray &lt;MeariDevice *&gt;*)devices success:(MeariSuccess_DeviceListForStatus)success failure:(MeariFailure)failure;

    //添加设备
    @param type 设备类型
    @param uuid 设备uuid
    @param sn 设备sn
    @param tp 设备tp
    @param success 成功回调
    @param failure 失败回调
    - (void)addDeviceWithDeviceType:(MeariDeviceType)type uuid:(NSString *)uuid sn:(NSString *)sn tp:(NSString *)tp success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //查询nvr
    [[MeariUser sharedInstance] checkDeviceStatusWithDeviceType:MeariDeviceTypeNvr devices:deviceArray success:^(NSArray&lt;MeariDevice *&gt; *devices) {

    } failure:^(NSError *error) {

    }];

    //添加nvr
    [[MeariUser sharedInstance] addDeviceWithDeviceType:MeariDeviceTypeNvr uuid:device.info.uuid sn:device.info.sn tp:device.info.tp success:^{

    } failure:^(NSError *error) {

    }];
</code></pre></div>

<h3 id="toc_42">(4) 停止搜索</h3>

<div><pre><code class="language-none">【描述】
    结束添加时，如果有开启搜索，需要停止搜索操作
【函数调用】
    /**
    停止搜索
    */
    + (void)stopSearch;
【代码范例】
    [MeariDevice stopSearch];
    [[MeariUser sharedInstance] cancelAllRequest];</code></pre></div>

<h1 id="toc_43">7 NVR绑定设备</h1>

<h2 id="toc_44">7.1 搜索设备</h2>

<div><pre><code class="language-none">【描述】
    设备蓝灯常亮才能被搜索到，用于展示给用户进行绑定NVR，MeariDevice-&gt;hasBindedNvr 用于判断是否已经绑定了NVR

【函数调用】
    /**
    开始搜索：搜索当前网络下的设备

    @param success 成功回调：返回搜索到的设备
    @param failure 失败回调
    */
    + (void)startSearch:(MeariDeviceSucess_SearchDevice)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //开始搜索：适用于smartwifi配网和ap配网
    [MeariDevice startSearch:^(MeariDevice *device) {

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_45">7.2 绑定设备</h2>

<div><pre><code class="language-none">【描述】
    NVR绑定设备后，设备的录像文件会存储在NVR中

【函数调用】
    @param deviceID 设备ID
    @param nvrID nvr ID
    @param success 成功回调
    @param failure 失败回调
    - (void)bindDevice:(NSInteger)deviceID toNVR:(NSInteger)nvrID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] bindDevice:model.device.info.ID toNVR:self.nvr.info.ID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_46">7.3 结束绑定设备</h2>

<div><pre><code class="language-none">【描述】
    结束绑定时，如果有开启搜索，需要停止搜索操作
【函数调用】
    /**
    停止搜索
    */
    + (void)stopSearch;
【代码范例】
    [MeariDevice stopSearch];
    [[MeariUser sharedInstance] cancelAllRequest];</code></pre></div>

<h2 id="toc_47">7.4 获取NVR绑定的设备</h2>

<div><pre><code class="language-none">【描述】
    用于查看NVR绑定了哪些设备

【函数调用】
    @param nvrID nvr ID
    @param success 成功回调：返回绑定的设备列表和未绑定的设备列表
    @param failure 失败回调
    - (void)getBindDeviceList:(NSInteger)nvrID success:(MeariSuccess_DeviceListForNVR)success failure:(MeariFailure)failure;

【代码范例】
    //查询绑定的设备列表
    [[MeariUser sharedInstance] getBindDeviceList:self.nvr.info.ID success:^(NSArray&lt;MeariDevice *&gt; *bindedDevices, NSArray&lt;MeariDevice *&gt; *unbindedDevices) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_48">7.5 从NVR解绑设备</h2>

<div><pre><code class="language-none">【描述】
    从NVR绑定设备后，设备的录像文件将不会继续存储在NVR中

【函数调用】
    @param deviceID 设备ID
    @param nvrID nvr ID
    @param success 成功回调
    @param failure 失败回调
    - (void)unbindDevice:(NSInteger)deviceID toNVR:(NSInteger)nvrID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
【代码范例】
    @param deviceIDs 多个设备ID
    @param nvrID nvr ID
    @param success 成功回调
    @param failure 失败回调
    [[MeariUser sharedInstance] unbindDevices:arr toNVR:self.nvr.info.ID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h1 id="toc_49">8.设备信息获取</h1>

<div><pre><code class="language-none">所属：MeariUser</code></pre></div>

<h2 id="toc_50">8.1 获取设备列类</h2>

<div><pre><code class="language-none">所属：MeariDeviceList</code></pre></div>

<div><pre><code class="language-none">【描述】
    设备添加后，通过MeariUser工具类的接口获取设备列表，以模型形式返回
设备信息为设备对象的info属性 (MeariDeviceInfo) 

【函数调用】
    //获取所有设备列表
    - (void)getDeviceList:(MeariSuccess_DeviceList)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getDeviceList:^(MeariDeviceList *deviceList) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<p>MeariDeviceList属性：</p>

<div><pre><code class="language-none"> /** 摄像机 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *ipcs;
/** 智能门铃 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *bells;
/** 语音门铃 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *voicebells;
/** 电池摄像机 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *batteryIpcs;
/** 灯具摄像机 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *lights;
/** 网络存储器 */
@property (nonatomic, strong) NSArray &lt;MeariDevice *&gt; *nvrs;</code></pre></div>

<h2 id="toc_51">8.2 设备信息</h2>

<div><pre><code class="language-none">所属：MeariDevice</code></pre></div>

<div><pre><code class="language-none">@property (nonatomic, strong) MeariDeviceInfo *info;                        //设备信息
@property (nonatomic, strong) MeariDeviceParam *param;                      //设备参数
@property (nonatomic, assign, readonly, getter=isIpcCommon)BOOL ipcCommon;  //是否是普通摄像机
@property (nonatomic, assign, readonly, getter=isIpcBaby)BOOL ipcBaby;      //是否是音乐摄像机
@property (nonatomic, assign, readonly, getter=isIpcBell)BOOL ipcBell;      //是否是门铃摄像机
@property (nonatomic, assign, readonly, getter=isNvr)BOOL nvr;              //是否是盒子
@property (nonatomic, assign)BOOL hasBindedNvr;                             //是否绑定
@property (nonatomic, assign, readonly)BOOL sdkLogined;                     //是否已登录
@property (nonatomic, assign, readonly)BOOL sdkLogining;                    //是否正在登录
@property (nonatomic, assign, readonly)BOOL sdkPlaying;                     //是否正在预览
@property (nonatomic, assign, readonly)BOOL sdkPlayRecord;                  //是否正在回放
@property (nonatomic, strong)NSDateComponents *playbackTime;                //当前回放时间
@property (nonatomic, assign, readonly)BOOL supportFullDuplex;              //是否支持双向语音对讲
@property (nonatomic, assign, readonly)BOOL supportVoiceTalk;               //是否支持语音对讲
。。。</code></pre></div>

<h2 id="toc_52">8.3 删除设备</h2>

<div><pre><code class="language-none">【描述】
    设备移除

【函数调用】
    //移除设备
    @param type 设备类型
    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)deleteDeviceWithDeviceType:(MeariDeviceType)type deviceID:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] deleteDeviceWithDeviceType:MeariDeviceTypeIpc deviceID:cell.camera.info.ID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_53">8.4 设备昵称修改</h2>

<div><pre><code class="language-none">【描述】
    设备昵称修改

【函数调用】
    @param type 设备类型
    @param deviceID 设备ID
    @param nickname 新的昵称，长度6-20位
    @param success 成功回调
    @param failure 失败回调
    - (void)renameDeviceWithDeviceType:(MeariDeviceType)type deviceID:(NSInteger)deviceID nickname:(NSString *)nickname success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //修改IPC设备昵称
    [[MeariUser sharedInstance] renameDeviceWithDeviceType:MeariDeviceTypeIpc deviceID:self.camera.info.ID nickname:newNickName success:^{
    
    } failure:^(NSError *error) {
    
    }];
    
    //修改NVR设备昵称
    [[MeariUser sharedInstance] renameDeviceWithDeviceType:MeariDeviceTypeNVR deviceID:self.nvr.info.ID nickname:newNickName success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_54">8.5 单个设备某天报警时间点获取</h2>

<div><pre><code class="language-none">【描述】
    单个设备某天报警时间点获取

【函数调用】
    //单个设备某天报警时间点获取
    @param deviceID 设备ID
    @param date 日期：格式为20171212
    @param success 成功回调：返回报警时刻列表
    @param failure 失败回调
    - (void)getAlarmMessageTimes:(NSInteger)deviceID onDate:(NSString *)date success:(MeariSuccess_DeviceAlarmMsgTime)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getAlarmMessageTimes:self.device.info.ID onDate:@&quot;20171212&quot; success:^(NSArray&lt;NSString *&gt; *time) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_55">8.6 查询设备是否有新版本</h2>

<div><pre><code class="language-none">【描述】
    查询设备是否有新版本

【函数调用】
    //查询设备是否有新版本
    @param currentFirmware 当前版本
    @param success 成功回调:返回设备最新版本信息
    @param failure 失败回调
    - (void)checkNewFirmwareWithCurrentFirmware:(NSString *)currentFirmware success:(MeariSuccess_DeviceFirmwareInfo)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] checkNewFirmwareWithCurrentFirmware:self.currentVersion success:^(MeariDeviceFirmwareInfo *info) {
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<p>MeariDeviceFirmwareInfo:</p>

<div><pre><code class="language-none">@property (nonatomic, copy) NSString *upgradeUrl;           //设备升级地址
@property (nonatomic, copy) NSString *latestVersion;        //设备最新版本
@property (nonatomic, copy) NSString *upgradeDescription;   //设备升级描述
@property (nonatomic, assign) BOOL needUpgrade;             //是否需要升级</code></pre></div>

<h2 id="toc_56">8.7 查询设备在线状态</h2>

<div><pre><code class="language-none">【描述】
    查询设备是否有新版本

【函数调用】
    //查询设备是否有新版本
    @param deviceID 设备ID
    @param success 成功回调：返回设备是否在线
    @param failure 失败回调
    - (void)checkDeviceOnlineStatus:(NSInteger)deviceID success:(MeariSuccess_DeviceOnlineStatus)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] checkDeviceOnlineStatus:self.device.info.ID success:^(BOOL online) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_57">8.8 查询音乐列表</h2>

<div><pre><code class="language-none">【描述】
    查询音乐列表

【函数调用】
    //查询音乐列表
    @param success 成功回调：返回音乐列表
    @param failure 失败回调
    - (void)getMusicList:(MeariSuccess_Music)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getMusicList:^(NSArray&lt;MeariMusicInfo *&gt; *musicList) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<div><pre><code class="language-none">MeariMusicInfo:
@property (nonatomic, strong) NSString * musicFormat;   //音乐格式
@property (nonatomic, strong) NSString * musicID;       //音乐ID
@property (nonatomic, strong) NSString * musicName;     //音乐名字
@property (nonatomic, strong) NSString * musicUrl;      //音乐地址</code></pre></div>

<h2 id="toc_58">8.9 生成配网二维码</h2>

<div><pre><code class="language-none">【描述】
    生成配网二维码

【函数调用】
    //获取二维码token
    /**
    获取配网token
    
    @param tokenType 不同配网模式对应不同的Token
    @param success 成功回调：
    token: 用于配网
    validTime: token有效时长，超过时长需要重新获取新的token
    @param failure 失败回调
    */
    - (void)getTokenForType:(MeariDeviceTokenType)tokenType success:(MeariSuccess_Token)success failure:(MeariFailure)failure;
    //生成配网二维码
    @param ssid wifi名称
    @param password wifi密码
    @param token 二维码token
    @param size 二维码大小
    @return 二维码图片
    - (UIImage *)createQRWithSSID:(NSString *)ssid pasword:(NSString *)password token:(NSString *)token size:(CGSize)size;

【代码范例】
    //获取二维码token
    [[MeariUser sharedInstance] getTokenForQrcode:^(NSString *token) {

    } failure:^(NSError *error) {

    }];
    
    //生成配网二维码
   UIImage *image = [[MeariUser sharedInstance] createQRWithSSID:weakSelf.wifi.ssid pasword:weakSelf.wifi.password token:obj size:CGSizeMake(WY_ScreenWidth, WY_ScreenHeight)];</code></pre></div>

<h2 id="toc_59">8.10 远程唤醒门铃</h2>

<div><pre><code class="language-none">【描述】
    远程唤醒门铃

【函数调用】
    //远程唤醒门铃
    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)remoteWakeUp:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] remoteWakeUp:self.camera.info.ID success:^{

    } failure:^(NSError *error) {

    }];
【注意事项】
    门铃类低功耗产品，需要先调用远程唤醒接口，再调用打洞的接口</code></pre></div>

<h2 id="toc_60">8.11 上传门铃留言</h2>

<div><pre><code class="language-none">【描述】
上传门铃留言

【函数调用】
    /**
    上传留言

    @param deviceID 设备ID
    @param file 留言文件路径
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)uploadVoice:(NSInteger)deviceID voiceFile:(NSString *)file success:(MeariSuccess_DeviceVoiceUrl)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] uploadVoice:self.camera.info.ID voiceFile:_filePath success:^(NSString *voiceUrl) {
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h2 id="toc_61">8.12 下载门铃留言</h2>

<div><pre><code class="language-none">【描述】
下载门铃留言

【函数调用】
    /**
    下载留言

    @param voiceUrl 留言地址
    @param success 成功回调，返回值：音频数据
    @param failure 失败回调
    */
    - (void)downloadVoice:(NSString *)voiceUrl success:(MeariSuccess_DeviceVoiceData)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] downloadVoice:urlStr success:^(NSData *data) {

    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h2 id="toc_62">8.13 删除门铃留言</h2>

<div><pre><code class="language-none">【描述】
删除门铃留言

【函数调用】
    /**
    删除留言

    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)deleteVoice:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] deleteVoice:self.camera.info.ID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h1 id="toc_63">9.设备控制</h1>

<div><pre><code class="language-none">所属：MeariDevice</code></pre></div>

<div><pre><code class="language-none">MeariDevice 负责对设备的所有操作，包括预览、回放、设置等，对设备的设置，需要确保已经与设备建立好了连接</code></pre></div>

<h2 id="toc_64">9.1 连接设备</h2>

<div><pre><code class="language-none">【描述】
    对设备进行预览、回放、设置等操作之前，需先连接上设备

【函数调用】
    /**
    开始连接设备

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startConnectSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    [self.device startConnectSuccess:^{

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_65">9.2 断开设备</h2>

<div><pre><code class="language-none">【描述】
    当不需要对设备进行操作时，需要断开设备

【函数调用】
    /**
    断开设备

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopConnectSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    [self.device stopConnectSuccess:^{

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_66">9.3 获取码率</h2>

<div><pre><code class="language-none">【描述】
    当不需要对设备进行操作时，需要断开设备

【函数调用】
    /**
    获取码率

    @return 码率
    */
    - (NSString *)getBitrates;

【代码范例】
    [self.device getBitrates]</code></pre></div>

<h2 id="toc_67">9.4 预览</h2>

<div><pre><code class="language-none">【描述】
    self.camera.supportVideoStreams

【函数调用】
    /**
    获取当前设备支持的码流类型
    MeariDeviceVideoStream_HD = 0,
    MeariDeviceVideoStream_360,
    MeariDeviceVideoStream_240,
    MeariDeviceVideoStream_480,
    MeariDeviceVideoStream_720,
    MeariDeviceVideoStream_1080,
    MeariDeviceVideoStream_1080_1_5,
    MeariDeviceVideoStream_1080_2_0,
    MeariDeviceVideoStreamNone,
    @return 处于休眠模式，镜头关闭，返回值：休眠模式
    */
    - (NSArray *)supportVideoStreams;</code></pre></div>

<div><pre><code class="language-none">【描述】
    预览时传入接口的videoStream类型，需要使用supportVideoStreams接口支持的其中一种

【函数调用】
    /**
    开始预览设备

    @param videoStream 视频清晰度
    @param success 成功回调
    @param streamCallback 码流回调
    @param failure 失败回调
    @param close 处于休眠模式，镜头关闭，返回值：休眠模式
    */
    - (void)startPreview2:(MeariDeviceVideoStream)videoStream success:(MeariDeviceSucess)success receiveStreamData:(MeariDeviceStreamDataCallback)streamCallback failure:(MeariDeviceFailure)failure close:(void(^)(MeariDeviceSleepmode sleepmodeType))close;


    /**
    停止预览设备

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopPreviewSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    切换高清标清

    @param videoStream 视频码流类型
    @param success 成功回调
    @param streamCallback 码流回调
    @param failure 失败回调
    */
    - (void)switchPreview:(MeariDeviceVideoStream)videoStream success:(MeariDeviceSucess)success receiveStreamData:(MeariDeviceStreamDataCallback)streamCallback failure:(MeariDeviceFailure)failure;

【代码范例】
    //开始预览设备
    [self.camera startPreview2:MeariDeviceVideoStream_720 success:^{

    } receiveStreamData:^(u_int8_t *buffer,MeariDeviceStreamType type, MEARIDEV_MEDIA_HEADER_PTR header, int bufferSize) {
            
    } failure:^(BOOL isPlaying) {

    } close:^(MeariDeviceSleepmode sleepmodeType) {

    }];

    //停止预览设备
    [self.camera stopPreviewSuccess:^{

    } failure:^(NSString *error) {

    }];

    //切换高清标清
    [self.camera switchPreview:videoStream success:MeariDeviceVideoStream_360 success:^{

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_68">9.5 回放</h2>

<div><pre><code class="language-none">【描述】
    对摄像机的录像进行回放
    注意：SDK不对播放的时间做校验，所以即使传入一个没有报警的时间点，接口也会返回成功，所以上层需要自行判断

【函数调用】
    /**
    获取某月的视频天数

    @param year 年
    @param month 月
    @param success 成功回调，返回值：json数组--[{&quot;date&quot; = &quot;20171228&quot;},...]
    @param failure 失败回调
    */
    - (void)getPlaybackVideoDaysWithYear:(NSInteger)year month:(NSInteger)month success:(MeariDeviceSucess_Days)success failure:(MeariDeviceFailure)failure;


    /**
    获取某天的视频片段

    @param year 年
    @param month 月
    @param day 日
    @param success 成功回调：返回值：json数组--[{&quot;endtime&quot; = &quot;20171228005958&quot;,&quot;starttime = 20171228000002&quot;},...]
    @param failure 失败回调
    */
    - (void)getPlaybackVideoTimesWithYear:(NSInteger)year month:(NSInteger)month day:(NSInteger)day success:(MeariDeviceSucess_Times)success failure:(MeariDeviceFailure)failure;

    /**
    开始回放录像：同一个设备同一时间只能一个人查看回放录像

    @param startTime 开始时间:格式为20171228102035
    @param success 成功回调
    @param streamCallback 码流回调
    @param failure 失败回调
    @param otherPlaying 其他人在查看回放
    */
    - (void)startPlayback:(NSString *)startTime success:(MeariDeviceSucess)success receiveStreamData:(MeariDeviceStreamDataCallback)streamCallback failure:(MeariDeviceFailure)failure;


    /**
    停止回放

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopPlackbackSDCardSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    从某时间开始播放：开始回放成功后才能使用此接口，否则会失败

    @param seekTime 开始时间:格式为20171228102035
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)seekPlaybackSDCardToTime:(NSString *)seekTime success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    暂停回放

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)pausePlackbackSDCardSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    继续回放

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)resumePlackbackSDCardSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取视频天数
    [self.device getPlaybackVideoDaysWithYear:year month:month success:^(NSArray *days) {

    } failure:^(NSString *error) {

    }];

    //获取某天视频时长
    [self.device getPlaybackVideoTimesWithYear:year month:month day:day success:^(NSArray *times) {

    } failure:^(NSString *error) {

    }];


    //开始回放录像
    [self.device startPlayback:starttime success:^{

    } receiveStreamData:^(u_int8_t *buffer,MeariDeviceStreamType type, MEARIDEV_MEDIA_HEADER_PTR header, int bufferSize) {
                   
    } failure:^(BOOL isPlaying) {

    } otherPlaying:^{

    }];

    //停止回放
    [self.device stopPlackbackSDCardSuccess:^{
    WYDo_Block_Safe_Main(success)
    } failure:^(NSString *error) {
    WYDo_Block_Safe_Main(success)
    }];

    //seek回放
    [self.device seekPlaybackSDCardToTime:self.currentComponents.timeStringWithNoSprit success:^{

    } failure:^(NSString *error) {

    }];

    //暂停回放
    [self.device pausePlackbackSDCardSuccess:^{

    } failure:^(NSString *error) {

    }];

    //继续回放
    [self.device resumePlackbackSDCardSuccess:^{

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_69">9.6 静音</h2>

<div><pre><code class="language-none">【描述】
    设置静音

【函数调用】
    /**
    设置静音

    @param muted 是否静音
    */
    - (void)setMute:(BOOL)muted;

【代码范例】

    //设置静音
    [self.device setMute:muted];
</code></pre></div>

<h2 id="toc_70">9.7 语音对讲</h2>

<h3 id="toc_71">(1) 单向对讲</h3>

<div><pre><code class="language-none">【描述】
    单向对讲是手机与设备不能同时讲话，手机端开始对讲调用startVoicetalk，讲话结束需要调用停止对讲stopVoicetalkSuccess，否则设备端讲话手机端无法接收到
    
【适用】
    subType:
    MeariDeviceSubTypeIpcCommon = 1,
    MeariDeviceSubTypeIpcBaby = 2,
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】

    /**
    设置语音对讲类型

    @param type 语音对讲类型
    */
    - (void)setVoiceTalkType:(MeariVoiceTalkType)type;

    /**
    获取语音对讲的实时音量

    @return 0-1.0
    */
    - (CGFloat)getVoicetalkVolume;

    /**
    开始语音对讲

    @param isDefault 是否使用默认方式，默认走SDK对讲
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startVoiceTalkDefault:(BOOL)isDefault success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
     音频每个声道的位数
     mBitsPerChannel : 16;
     音频编码格式
     mFormatID : kAudioFormatLinearPCM;
     音频采样率
     mSampleRate : 8000.0;
     音频每个声道的帧数
     mChannelsPerFrame : 1;
     
     *@brief 如果不使用sdk默认对讲方式，需要手动发送音频数据
     *@param[in] data pcm 数据
     *@param[in] len  pcm 长度
     */
    - (void)sendVoiceData:(uint8_t*)data length:(size_t)len;

    /**
    停止语音对讲
     @param isDefault 是否使用默认方式，默认走SDK对讲
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopVoicetalkDefault:(BOOL)isDefault success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

     //设置语音对讲类型
    [self.camera setVoiceTalkType:MeariVoiceTalkTypeOneWay];

    //获取语音对讲的实时音量
    [self.camera getVoicetalkVolume]


    //开始语音对讲
    [self.camera startVoicetalkSuccess:^{

    } failure:^(NSString *error) {

    }];

    //停止语音对讲
    [self.camera stopVoicetalkSuccess:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h3 id="toc_72">(2) 双向对讲</h3>

<div><pre><code class="language-none">【描述】
    双向对讲是手机与设备**可以**同时讲话，手机端开始对讲调用startVoicetalk，不调用stopVoicetalkSuccess，不会影响设备端传来声音
    
【适用】
    subType:
    MeariDeviceSubTypeIpcBell = 3,
    MeariDeviceSubTypeIpcBattery = 4,

【函数调用】

    /**
    设置语音对讲类型

    @param type 语音对讲类型
    */
    - (void)setVoiceTalkType:(MeariVoiceTalkType)type;

    /**
    开始语音对讲

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startVoicetalkSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
    停止语音对讲

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopVoicetalkSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

     //设置语音对讲类型
    [self.camera setVoiceTalkType:MeariVoiceTalkTypeFullDuplex];

 
    //开始语音对讲
    [self.camera startVoicetalkSuccess:^{

    } failure:^(NSString *error) {

    }];

    //停止语音对讲
    [self.camera stopVoicetalkSuccess:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h3 id="toc_73">(3) 语音门铃对讲</h3>

<div><pre><code class="language-none">【描述】
    语音门铃对讲有别于其他对讲方式，支持双向对讲，如果手机端需要将麦克关闭，可以调用暂停接口，当需要重新打开麦克时需要重置对讲操作
    
【适用】
    subType:
    MeariDeviceSubTypeIpcVoiceBell = 5,

【函数调用】
    /**
    设置语音对讲类型

    @param type 语音对讲类型
    */
    - (void)setVoiceTalkType:(MeariVoiceTalkType)type;

    /**
    开始语音对讲

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startVoicetalkSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
     关闭手机端麦克
     
     @param success 成功回调
     @param failure 成功回调
     */
    - (void)pauseVoicetalkSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
     开启手机端麦克
     
     @param success 成功回调
     @param failure 成功回调
     */
    - (void)resumeVoicetalkSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

     //设置语音对讲类型
    [self.camera setVoiceTalkType: MeariVoiceTalkTypeFullDuplex];

    //开始语音对讲
    [self.camera startVoicetalkSuccess:^{

    } failure:^(NSString *error) {

    }];
    
    //关闭手机端麦克
    [self.camera pauseVoicetalkSuccess:^{
    
    } failure:^(NSError *error) {
    
    };
    
    //开启手机端麦克
    [self.camera resumeVoicetalkSuccess:^{
    
    } failure:^(NSError *error) {
    
    };
</code></pre></div>

<h2 id="toc_74">9.8 截图</h2>

<div><pre><code class="language-none">【描述】
    截取视频图片

【函数调用】

    /**
    截图

    @param path 图片保存的路径
    @param isPreviewing 是否正在预览
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)snapshotToPath:(NSString *)path isPreviewing:(BOOL)isPreviewing success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //截图
    [self.camera snapshotToPath:snapShotPath isPreviewing:_isPreviewing success:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_75">9.9 录像</h2>

<div><pre><code class="language-none">【描述】
    对视频录像

【函数调用】
    /**
    开始录像

    @param path 录像保存的路径
    @param isPreviewing 是否正在预览
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startRecordMP4ToPath:(NSString *)path isPreviewing:(BOOL)isPreviewing success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    停止录像

    @param isPreviewing 是否正在预览
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopRecordMP4IsPreviewing:(BOOL)isPreviewing success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //开始录像
    [self.camera startRecordMP4ToPath:path isPreviewing:_isPreviewing success:^{

    } failure:^(NSString *error) {

    }];

    //停止录像
    [self.nvr stopRecordMP4IsPreviewing:_isPreviewing success:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_76">9.10 云台控制</h2>

<div><pre><code class="language-none">【描述】
    转动摄像机

【函数调用】

/**
    开始转动摄像机

    @param direction 转动方向
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)startMoveToDirection:(MeariMoveDirection)direction success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    停止转动摄像机

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)stopMoveSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //开始转动
    [self.camera startMoveToDirection:MeariMoveDirectionUp success:^{

    } failure:^(NSString *error) {

    }];

    //停止转动
    [self.camera stopMoveSuccess:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_77">9.11 镜像</h2>

<div><pre><code class="language-none">【描述】
    镜像状态的获取与设置

【函数调用】

    /**
    获取镜像状态

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)getMirrorSuccesss:(MeariDeviceSucess_Mirror)success failure:(MeariDeviceFailure)failure;


    /**
    设置镜像

    @param open 是否打开镜像
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setMirrorOpen:(BOOL)open successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //开始转动
    [self.camera startMoveToDirection:MeariMoveDirectionUp success:^{

    } failure:^(NSString *error) {

    }];

    //停止转动
    [self.camera stopMoveSuccess:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_78">9.12 移动侦测报警</h2>

<div><pre><code class="language-none">【描述】
    报警信息的获取与设置

【函数调用】

    /**
    获取报警信息

    @param success 成功回调，返回值：报警参数信息
    @param failure 失败回调
    */
    - (void)getAlarmSuccesss:(MeariDeviceSucess_Motion)success failure:(MeariDeviceFailure)failure


    /**
    设置报警级别

    @param level 报警级别
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setAlarmLevel:(MeariDeviceLevel)level successs:(MeariDeviceSucess_ID)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //获取报警信息
    [self.camera getAlarmSuccesss:^(MeariDeviceParamMotion *motion) {

    } failure:^(NSString *error) {

    }];

    //设置报警级别
    [self.camera setAlarmLevel:level successs:^(id obj) {

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_79">9.13 存储 (SD卡)</h2>

<div><pre><code class="language-none">【描述】
    存储的信息获取与格式化

【函数调用】
    /**
    获取存储信息

    @param success 成功回调，返回存储信息
    @param failure 失败回调
    */
    - (void)getStorageInfoSuccess:(MeariDeviceSucess_Storage)success failure:(MeariDeviceFailure)failure;


    /**
    获取内存卡格式化百分比

    @param success 成功回调,返回格式化百分比
    @param failure 失败回调
    */
    - (void)getFormatPercentSuccesss:(MeariDeviceSucess_StoragePercent)success failure:(MeariDeviceFailure)failure;

    /**
    格式化内存卡

    @param success 成功回调
    @param failure 失败回道
    */
    - (void)formatSuccesss:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】

    //获取存储信息
    [self.device getStorageInfoSuccess:^(MeariDeviceParamStorage *storage) {

    } failure:^(NSString *error) {

    }];

    //获取格式化百分比
    [self.device getFormatPercentSuccesss:^(NSInteger percent) {

    } failure:^(NSString *error) {

    }];

    //格式化内存卡
    [self.device formatSuccesss:^{

    } failure:^(NSString *error) {

    }];
</code></pre></div>

<h2 id="toc_80">9.14 固件升级</h2>

<h3 id="toc_81">(1) 在线升级</h3>

<div><pre><code class="language-none">【描述】
    固件的信息获取与升级，点升级设备会立即进行升级操作，
    注意：需要在设备在线并建立连接成功后才能操作
    
【适用】
    subType:
    MeariDeviceSubTypeIpcCommon = 1,
    MeariDeviceSubTypeIpcBaby = 2,
    MeariDeviceSubTypeIpcBell = 3,
    MeariDeviceSubTypeIpcBattery = 4,
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】

    /**
    获取固件版本

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)getVersionSuccesss:(MeariDeviceSucess_Version)success failure:(MeariDeviceFailure)failure;


    /**
    获取固件升级百分比

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)getUpgradePercentSuccesss:(MeariDeviceSucess_VersionPercent)success failure:(MeariDeviceFailure)failure;


    /**
    升级固件

    @param url 固件包地址
    @param currentVersion 固件当前版本号
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)upgradeWithUrl:(NSString *)url currentVersion:(NSString *)currentVersion successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


【代码范例】

    //获取固件版本
    [self getVersionSuccesss:^(id obj) {

    } failure:^(NSError *error) {

    }];

    //获取固件升级百分比
    [self.camera getUpgradePercentSuccesss:^(NSInteger percent) {

    } failure:^(NSError *error) {

    }];

    //升级固件
    [weakSelf.camera upgradeWithUrl:weakSelf.devUrl currentVersion:weakSelf.currentVersion successs:^{

    } failure:^(NSError *error) {

    }];
</code></pre></div>

<h3 id="toc_82">(2) 计划升级</h3>

<div><pre><code class="language-none">【描述】
    固件的信息获取与升级，点升级设备不会立即进行升级操作，需要等设备启动后才会执行升级计划
    注意：设备不在线也可进行升级操作
    
【适用】
    subType: 
    MeariDeviceSubTypeIpcVoiceBell = 5,

【函数调用】
    1、先获取设备版本信息
    /**
     获取版本信息：param.voiceBell.deviceVersion
    
     @param success 成功回调，返回值：设备参数信息
     @param failure 失败回调
     */
    - (void)getParamsSuccesss:(MeariDeviceSucess_Param)success failure:(MeariDeviceFailure)failure;
    
   2、检查是否需要升级
   [MeariUser:checkNewFirmwareWithCurrentFirmware](#8.6 查询设备是否有新版本)
    
    3、执行升级操作
    /**
     升级固件
     
     @param url 固件包地址
     @param latestVersion 最新固件版本号
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)upgradeVoiceBellWithUrl:(NSString *)url latestVersion:(NSString *)latestVersion successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure ;


【代码范例】

    [self.device getParamsSuccesss:^(MeariDeviceParam *param) {
       weakSelf.deviceUrl = param.voiceBell.deviceVersion;
        [[MeariUser sharedInstance] checkNewFirmwareWithCurrentFirmware:weakSelf.deviceUrl success:^(MeariDeviceFirmwareInfo *info) {
            [weakSelf.device upgradeVoiceBellWithUrl:info.upgradeUrl latestVersion:info.latestVersion successs:^{
                NSLog(@&quot;升级语音门铃成功&quot;);
            } failure:^(NSError *error) {
                NSLog(@&quot;升级语音门铃失败%@&quot;,error);
            }];
        } failure:^(NSError *error) {
                
        }];
    } failure:^(NSError *error) {
              
    }];
</code></pre></div>

<h2 id="toc_83">9.15 获取参数信息</h2>

<div><pre><code class="language-none">【描述】
    获取设备的所有参数信息，对设备设置的功能参数，可以通过此接口获取，在设备调用成功的

【函数调用】
    /**
    获取所有参数

    @param success 成功回调，返回值：设备参数信息
    @param failure 失败回调
    */
    - (void)getParamsSuccesss:(MeariDeviceSucess_Param)success failure:(MeariDeviceFailure)failure;

【代码范例】
    [self.camera getParamsSuccesss:^(WYCameraParams *params) {

    } failure:^(NSString *error) {

    }];</code></pre></div>

<h2 id="toc_84">9.16 休眠模式</h2>

<div><pre><code class="language-none">【描述】
    设置不同的模式控制设备镜头，
    MeariDeviceSleepmodeLensOn ： 镜头打开
    MeariDeviceSleepmodeLensOff ： 镜头永久关闭
    MeariDeviceSleepmodeLensOffByTime ： 镜头按时间段关闭
    MeariDeviceSleepmodeLensOffByGeographic ： 镜头根据地理位置关闭

【函数调用】
    /**
    设置休眠模式

    @param type 休眠模式
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setSleepmodeType:(MeariDeviceSleepmode)type successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
    设置休眠时间段

    @param open 是否开启休眠模式
    @param times 休眠时间段
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setSleepmodeTime:(BOOL)open times:(NSArray &lt;MeariDeviceParamSleepTime *&gt;*)times successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
     设置地理围栏
    
     @param ssid wifi的SSID
     @param bssid wifi的BSSID
     @param deviceID 设备ID
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)settingGeographyWithSSID:(NSString *)ssid BSSID:(NSString *)bssid deviceID:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //设置休眠模式
    [self.camera setSleepmodeType:model.type successs:^{

    } failure:^(NSError *error) {

    }];

    //设置休眠时间段
    [self.camera setSleepmodeTime:open times:timesArr successs:^{

    }failure:^(NSError *error) {

    }];
    
    //设置WiFi信息
    [[MeariUser sharedInstance] settingGeographyWithSSID:(NSString *)ssid BSSID:(NSString *)bssid deviceID:(NSInteger)deviceID success:^(NSString *str){
    
    } failure:^(NSError *error){

    }];
    </code></pre></div>

<h2 id="toc_85">9.17 温湿度</h2>

<div><pre><code class="language-none">【描述】
    获取设备的所有参数信息

【函数调用】

    /**
    获取温湿度

    @param success 成功回调，返回值：温度和湿度
    @param failure 失败回调
    */
    - (void)getTemperatureHumiditySuccesss:(MeariDeviceSucess_TRH)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //设置休眠模式
    [self.camera getTemperatureHumiditySuccesss:^(CGFloat temperature, CGFloat humidty) {

    } failure:^(NSError *error) {
        if (error.code == MeariDeviceCodeNoTemperatureAndHumiditySensor) {
        //没有温湿度传感器
        }else {

        }
    }];</code></pre></div>

<h2 id="toc_86">9.18 音乐</h2>

<div><pre><code class="language-none">【描述】
    获取设备音乐状态，控制设备播放音乐，需要有内存卡才能播放

【函数调用】

    /**
    播放音乐

    @param musicID 音乐ID
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)playMusic:(NSString *)musicID successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    暂停播放音乐

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)pauseMusicSuccesss:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

    /**
    继续播放音乐

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)resumeMusicSuccesss:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    播放下一首

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)playNextMusicSuccesss:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    播放前一首

    @param success 成功回调
    @param failure 失败回调
    */
    - (void)playPreviousMusicSuccesss:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


    /**
    获取音乐状态：包括播放和下载状态

    @param success 成功回调,返回值：json字典
    @param failure 失败回调
    */
    - (void)getMusicStateSuccesss:(MeariDeviceSucess_MusicStateAll)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //开始播放音乐
    [self.camera playMusic:musicID successs:^{
    } failure:^(NSError *error) {

    }];

    //暂停播放音乐
    [self.camera pauseMusicSuccesss:^{

    } failure:^(NSError *error) {

    }];

    //继续播放音乐
    [self.camera resumeMusicSuccesss:^{

    } failure:^(NSError *error) {

    }];

    //播放下一首音乐
    [self.camera playNextMusicSuccesss:^{

    } failure:^(NSError *error) {

    }];

    //播放上一首音乐
    [self.camera playPreviousMusicSuccesss:^{

    } failure:^(NSError *error) {

    }];

    //获取所有音乐的播放状态
    [self.camera getMusicStateSuccesss:^(NSDictionary *allMusicState) {

    } failure:^(NSError *error) {

    }];
</code></pre></div>

<h2 id="toc_87">9.19 设备音量</h2>

<div><pre><code class="language-none">【描述】
    设备输出音量的获取与设置

【函数调用】

    /**
    获取设备输出音量

    @param success 成功回调，返回值：设备输出音量，0-100
    @param failure 失败回调
    */
    - (void)getOutputVolumeSuccesss:(MeariDeviceSucess_Volume)success failure:(MeariDeviceFailure)failure;


    /**
    设置设备输出音量

    @param volume 音量，0-100
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setOutputVolume:(NSInteger)volume successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取设备输出音量
    [self.camera getOutputVolumeSuccesss:^(CGFloat volume) {

    } failure:^(NSError *error) {

    }];

    //设置设备输出音量
    [self.camera setOutputVolume:volume successs:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_88">9.20 门铃音量</h2>

<h3 id="toc_89">(1) 可视门铃</h3>

<div><pre><code class="language-none">【描述】
    门铃输出音量的获取与设置
    
【适用】
    subType:
    MeariDeviceSubTypeIpcBell = 3,

【函数调用】
    /**
    设置门铃输出音量

    @param volume 音量
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setDoorBellVolume:(NSInteger)volume success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取门铃输出音量
    [self.camera setDoorBellVolume:roundf(slider.value) success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_90">(2) 语音门铃</h3>

<div><pre><code class="language-none">【描述】
    门铃输出音量的获取与设置,注意此设置非立即生效，需要等设备启动一次后才可以生效
    
【适用】
    subType:
    MeariDeviceSubTypeIpcVoiceBell = 5,

【函数调用】
    /**
    设置语音门铃声音
    
    @param volume 0~100
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setVoiceBellVolume:(NSInteger)volume success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //设置语音门铃声音
    [self.device setVoiceBellVolume:50 success:^{
        NSLog(@&quot;set voice bell volume success-%ld&quot;,weakSelf.device.param.voiceBell.ringSpeakerVolume);
    } failure:^(NSError *error) {
        NSLog(@&quot;set voice bell volume failure&quot;);
    }];</code></pre></div>

<h2 id="toc_91">9.21 铃铛设置</h2>

<h3 id="toc_92">(1) 可视门铃</h3>

<div><pre><code class="language-none">【描述】
    门铃输出音量的获取与设置
    
【适用】
    subType:
    MeariDeviceSubTypeIpcBell = 3,

【函数调用】
    /**
     设置无线铃铛
     
     @param volumeType 铃铛声音等级
     @param selectedSong 选中的铃声
     @param repeatTimes 重复次数
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)setDoorBellJingleBellVolumeType:(MeariDeviceLevel)volumeType selectedSong:(NSString *)selectedSong repeatTimes:(NSInteger)repeatTimes success:(MeariDeviceSucess_ID)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //设置无线铃铛
    [self.camera setDoorBellJingleBellVolumeType:_jingleBellVolumeLevel selectedSong:self.selectedSong repeatTimes:_repeatTimes success:^(id obj) {
        [SVProgressHUD wy_showToast:WYLocalString(@&quot;success_set&quot;)];
    } failure:^(NSError *error) {
        [SVProgressHUD wy_showToast:WYLocalString(@&quot;fail_set&quot;)];
    }];
</code></pre></div>

<h3 id="toc_93">(2) 语音门铃</h3>

<div><pre><code class="language-none">【描述】
    门铃输出音量的获取与设置,注意此设置非立即生效，需要等设备启动一次后才可以生效
    
【适用】
    subType:
    MeariDeviceSubTypeIpcVoiceBell = 5,

【函数调用】
    /**
     设置铃铛属性
     @param volumeLevel
        静音=MeariDeviceLevelOff
        低=MeariDeviceLevelLow
        中=MeariDeviceLevelMedium
        高=MeariDeviceLevelHigh
     @param durationLevel
        短=MeariDeviceLevelLow
        中=MeariDeviceLevelMedium
        长=MeariDeviceLevelHigh
     @param index   1~10
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)setVoiceBellCharmVolume:(MeariDeviceLevel)volumeLevel songDuration:(MeariDeviceLevel)durationLevel songIndex:(NSInteger)index success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


【代码范例】
    //设置无线铃铛
    [self.device setVoiceBellCharmVolume: MeariDeviceLevelLow songDuration:MeariDeviceLevelLow songIndex:1 success:^{
        NSLog(@&quot;set voice bell charm success-Volume-%ld-Duration-%ld-songIndex-%ld&quot;,weakSelf.device.param.voiceBell.jingleVolume,weakSelf.device.param.voiceBell.jingleDuration,weakSelf.device.param.voiceBell.jingleRing);
    } failure:^(NSError *error) {
        NSLog(@&quot;set voice bell charm success&quot;);
    }];
</code></pre></div>

<h2 id="toc_94">9.22 留言设置</h2>

<div><pre><code class="language-none">【描述】
    设置客人留言参数,注意此设置非立即生效，需要等设备启动一次后才可以生效
    
【适用】
    subType:
    MeariDeviceSubTypeIpcVoiceBell = 5,

【函数调用】
    /**
    设置访客留言
    
    @param enterTime 按门铃后进入留言时间10/20/30...60s
    @param durationTime 可留言时长10/20/30...60s
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setVoiceBellEnterMessageTime:(NSInteger)enterTime messageDurationTime:(NSInteger)durationTime success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;


【代码范例】
    //设置无线铃铛
    [self.device setVoiceBellCharmVolume: MeariDeviceLevelLow songDuration:MeariDeviceLevelLow songIndex:1 success:^{
        NSLog(@&quot;set voice bell charm success-Volume-%ld-Duration-%ld-songIndex-%ld&quot;,weakSelf.device.param.voiceBell.jingleVolume,weakSelf.device.param.voiceBell.jingleDuration,weakSelf.device.param.voiceBell.jingleRing);
    } failure:^(NSError *error) {
        NSLog(@&quot;set voice bell charm success&quot;);
    }];
</code></pre></div>

<h2 id="toc_95">9.23 人体侦测报警</h2>

<div><pre><code class="language-none">【描述】
    门铃PIR报警的获取与设置：获取需要用调用参数接口

【函数调用】
    //门铃PIR报警获取，参见 7.15 获取参数信息
    /**
    获取所有参数

    @param success 成功回调，返回值：设备参数信息
    @param failure 失败回调
    */
    - (void)getParamsSuccesss:(MeariDeviceSucess_Param)success failure:(MeariDeviceFailure)failure;

    /**
    设置门铃PIR(人体侦测)报警类型

    @param level 报警级别
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setDoorBellPIRLevel:(MeariDeviceLevel)level successs:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取门铃PIR报警信息
    [self.camera getParamsSuccesss:^(MeariDeviceParam *params) {

    } failure:^(NSError *error) {

    }];

    //设置门铃PIR(人体侦测)报警类型
    [self.camera setDoorBellPIRLevel:level successs:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_96">9.24 门铃低功耗</h2>

<div><pre><code class="language-none">【描述】
    门铃低功耗的获取与设置：获取需要用调用参数接口

【函数调用】
    //门铃低功耗获取，参见 7.15 获取参数信息
    /**
    获取所有参数

    @param success 成功回调，返回值：设备参数信息
    @param failure 失败回调
    */
    - (void)getParamsSuccesss:(MeariDeviceSucess_Param)success failure:(MeariDeviceFailure)failure;

    /**
    设置门铃低功耗

    @param open 是否打开低功耗模式
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setDoorBellLowPowerOpen:(BOOL)open success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取门铃低功耗
    [self.camera getParamsSuccesss:^(MeariDeviceParam *params) {

    } failure:^(NSError *error) {

    }];

    //设置门铃低功耗打开或关闭
    [self.camera setDoorBellLowPowerOpen:open success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_97">9.25 门铃电池锁</h2>

<div><pre><code class="language-none">【描述】
    门铃电池锁的获取与设置：获取需要用调用参数接口

【函数调用】
    //门铃电池锁获取，参见 7.15 获取参数信息
    /**
    获取所有参数

    @param success 成功回调，返回值：设备参数信息
    @param failure 失败回调
    */
    - (void)getParamsSuccesss:(MeariDeviceSucess_Param)success failure:(MeariDeviceFailure)failure;

    /**
    设置门铃电池锁

    @param open 是否打开电池锁
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setDoorBellBatteryLockOpen:(BOOL)open success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;

【代码范例】
    //获取门铃电池锁
    [self.camera getParamsSuccesss:^(MeariDeviceParam *params) {

    } failure:^(NSError *error) {

    }];

    //设置门铃低功耗打开或关闭
    [self.camera setDoorBellBatteryLockOpen:open success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_98">9.26 留言</h2>

<h3 id="toc_99">(1) 主人留言</h3>

<div><pre><code class="language-none">【描述】
    主人可为设备设置留言，主人可以在手机端控制设备播放自己录制的留言

【适用】
    subType:
    MeariDeviceSubTypeIpcBell = 3,
    
【函数调用】

    /**
    开始留言

    @param path 留言文件路径
    */
    - (void)startRecordAudioToPath:(NSString *)path;

    /**
    停止留言

    @param success 成功回调，返回值：留言文件路径
    */
    - (void)stopRecordAudioSuccess:(MeariDeviceSucess_RecordAutio)success;

    /**
    开始播放留言

    @param filePath 留言文件路径
    @param finished 完成回调
    */
    - (void)startPlayRecordedAudioWithFile:(NSString *)filePath finished:(MeariDeviceSucess)finished;

    /**
    停止播放留言
    */
    - (void)stopPlayRecordedAudio;


【代码范例】
    //开始留言
    [self.camera startRecordAudioToPath:_filePath];

    //停止留言
    [self.camera stopRecordAudioSuccess:^(NSString *filePath) {

    }];

    //开始播放留言
    [self.camera startPlayRecordedAudioWithFile:_filePath finished:^{

    }];

    //停止播放留言
    [self.camera stopPlayRecordedAudio];
</code></pre></div>

<h3 id="toc_100">(2) 客人留言</h3>

<div><pre><code class="language-none">【描述】
    在客人按门铃后无人响应，设备会进入留言模式，客人可以对设备进行留言，主人可通过手机App查看客人留言信息

【适用】
    subType:
    MeariDeviceSubTypeIpcVoiceBell = 5,
    
【函数调用】
    1、获取访客信息
    /**
     获取设备的访客事件
     注：包括接听、挂断、留言信息
     
     @param deviceID 设备ID
     @param pageNum 页数 1~
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)getVisitorMessageListForDevice:(NSInteger)deviceID pageNum:(NSInteger)pageNum success:(MeariSuccess_MsgVoiceDeviceList)success failure:(MeariFailure)failure;
    
    2、获取语音数据
    /**
     获取语音数据
     
     @param remoteUrl 音频网络地址
     @param sourceData 成功回调音频数据
     @param failure 失败回调
     */
    - (void)getVoiceMessageAudioData:(NSString *)remoteUrl deviceID:(NSInteger)deviceID success:(MeariSuccess_DeviceVoiceData)sourceData failure:(MeariFailure)failure;

    3、播放语音数据
    /**
     开始播放客人留言
     
     @param filePath 本地语音文件路径
     @param finished 完成回调
     */
    - (void)startPlayVoiceMessageAudioWithFile:(NSString *)filePath finished:(MeariDeviceSucess)finished;
    
    4、停止播放语音数据
    /**
     停止播放客人留言
     */
    - (void)stopPlayVoiceMessageAudio;

    5、标记消息已读
    /**
     标记消息为已读
     
     @param messageID 消息ID
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)markReadVoiceMessage:(NSInteger)messageID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
    6、删除单条消息 (接听、挂断、留言信息) 
    /**
     删除某个设备的单条消息
     
     @param messageID 消息ID
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)deleteVoiceMessage:(NSInteger)messageID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
    7、删除所有消息 (接听、挂断、留言信息) 
    /**
     删除某个设备下所有消息
     
     @param deviceID 设备ID
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)deleteAllVoiceMessage:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
    
【代码范例】
   所属：MeariSDK：WYVoiceDoorbellAlarmMsgDetailVC.h
</code></pre></div>

<h2 id="toc_101">9.27 设备播放留言</h2>

<div><pre><code class="language-none">【描述】
    播放留言

【函数调用】

    /**
    播放留言

    @param success 成功回调
    @param failure 成功回调
    */
    - (void)playMessageSuccess:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;     


【代码范例】

    //控制设备播放留言
    [self.camera playMessageSuccess:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_102">9.28 灯具摄像机设置</h2>

<h3 id="toc_103">(1) 开关灯</h3>

<div><pre><code class="language-none">【描述】
    控制灯的开关
    
【适用】
    subType:
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】
    /**
    设置灯开关
    
    @param on 灯开关
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setFlightCameraLightOn:(BOOL)on success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure; 


【代码范例】
      //设置灯开关
     [self.camera setFlightCameraLightOn:isOn success:^{
     
     } failure:^(NSError *error) {
    
     }];</code></pre></div>

<h3 id="toc_104">(2) 报警器开关</h3>

<div><pre><code class="language-none">【描述】
    通过设备控制报警器的开关，以达到警示的作用
    
【适用】
    subType:
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】

    
    /**
    设置警报开关
    
    @param on 警报开关
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setFlightCameraSiren:(BOOL)on success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;     


【代码范例】
    //设置警报开关
    [weakSelf.camera setFlightCameraSiren:NO success:^{

    } failure:^(NSError *error) {
  
    }];
</code></pre></div>

<h3 id="toc_105">(3) 按时间段开灯</h3>

<div><pre><code class="language-none">【描述】
    给设备设置一个时间段，当设备在设置的时间段内，设备会讲灯打开，时间截止则控制灯关闭
    
【适用】
    subType:
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】

    /**
    设置灯具开灯计划
    
    @param on 是否使能
    @param fromDateStr 开始时间
    @param toDateStr 结束时间
    @param success 成功回调
    @param failure 失败回调
    */
    - (void)setFlightCameraScheduleOn:(BOOL)on fromDate:(NSString *)fromDateStr toDate:(NSString *)toDateStr success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;   


【代码范例】

    //  设置灯具开灯计划
     [self.camera setFlightCameraScheduleOn:self.lightSwitch.isOn fromDate:_timeArray[0] toDate:_timeArray[1]  success:^{

    } failure:^(NSError *error) {
 
    }];</code></pre></div>

<h3 id="toc_106">(4) 按报警事件开关灯</h3>

<div><pre><code class="language-none">【描述】
    打开移动报警开灯后，设备监测到人体移动，会将灯打开，持续一段时间后熄灭
    
【适用】
    subType:
    MeariDeviceSubTypeIpcFloodlight = 6,

【函数调用】

    /**
     设置灯具的移动监测
    
     @param on 是否使能
     @param level 不同等级对应的亮灯时间 MeariDeviceLevelLow : 20s , MeariDeviceLevelMedium : 40s, MeariDeviceLevelHigh: 60s
     @param success 成功回调
     @param failure 失败回调
     */
    - (void)setFlightCameraMotionOn:(BOOL)on durationLevel:(MeariDeviceLevel)level success:(MeariDeviceSucess)success failure:(MeariDeviceFailure)failure;   


【代码范例】

    NSInteger durationTime = [duration integerValue];
    MeariDeviceLevel level =  MeariDeviceLevelLow;
    if (durationTime == 20) {
        level = MeariDeviceLevelLow;
    }else  if (durationTime == 40) {
        level = MeariDeviceLevelMedium;
    }else  if (durationTime == 60){
       level = MeariDeviceLevelHigh;
    }
    [self.camera setFlightCameraMotionOn:isOn durationLevel:level success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h1 id="toc_107">10.共享设备</h1>

<h2 id="toc_108">10.1 好友管理</h2>

<h3 id="toc_109">(1) 添加好友</h3>

<div><pre><code class="language-none">【描述】
    请求添加好友

【函数调用】
    //请求添加好友
    @param userAccount 好友账号
    @param success 成功回调
    @param failure 失败回调
    - (void)addFriend:(NSString *)userAccount success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] addFriend:self.searchView.text success:^{

    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_110">(2) 删除好友</h3>

<div><pre><code class="language-none">【描述】
    删除好友

【函数调用】
    //删除好友
    @param friendIDs 多个好友ID
    @param success 成功回调
    @param failure 失败回调
    - (void)deleteFriends:(NSArray &lt;NSNumber *&gt; *)friendIDs success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] deleteFriends:userIDs success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_111">(3) 修改好友昵称</h3>

<div><pre><code class="language-none">【描述】
    修改好友昵称

【函数调用】
    //修改好友昵称
    @param friendID 好友ID
    @param nickname 好友昵称
    @param success 成功回调
    @param failure 失败回调
    - (void)renameFriend:(NSInteger)friendID nickname:(NSString *)nickname success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] renameFriend:self.model.info.userID nickname:self.tf.text success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_112">(4) 获取好友列表</h3>

<div><pre><code class="language-none">【描述】
    获取好友列表
    所属：MeariFriendInfo

【函数调用】
    //获取好友列表
    @param success 成功回调：返回好友列表
    @param failure 失败回调
    - (void)getFriendList:(MeariSuccess_FriendList)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getFriendList:^(NSArray&lt;MeariFriendInfo *&gt; *friends) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_113">10.2 添加分享</h2>

<h3 id="toc_114">(1) 分享单个设备</h3>

<div><pre><code class="language-none">【描述】
    分享单个设备给指定用户

【函数调用】
    //主动分享设备
    @param type 设备类型
    @param deviceID 设备ID
    @param friendID 好友ID
    @param success 成功回调
    @param failure 失败回调
    - (void)shareDeviceWithDeviceType:(MeariDeviceType)type deviceID:(NSInteger)deviceID toFriend:(NSInteger)friendID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] shareDeviceWithDeviceType:MeariDeviceTypeIpc deviceID:self.deviceID toFriend:model.info.userID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_115">(2) 取消单个设备分享</h3>

<div><pre><code class="language-none">【描述】
    取消单个设备分享

【函数调用】
    //取消单个设备分享
    @param type 设备类型
    @param deviceID 设备ID
    @param friendID 好友ID
    @param success 成功回调
    @param failure 失败回调
    - (void)cancelShareDeviceWithDeviceType:(MeariDeviceType)type deviceID:(NSInteger)deviceID toFriend:(NSInteger)friendID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] cancelShareDeviceWithDeviceType:MeariDeviceTypeIpc deviceID:self.deviceID toFriend:model.info.userID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h3 id="toc_116">(3) 请求分享某个设备</h3>

<div><pre><code class="language-none">【描述】
    请求分享某个设备

【函数调用】
    //请求分享某个设备
    @param type 设备类型
    @param sn 设备sn
    @param success 成功回调
    @param failure 失败回调
    - (void)requestShareDeviceWithDeviceType:(MeariDeviceType)type sn:(NSString *)sn success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] requestShareDeviceWithDeviceType:MeariDeviceTypeIpc sn:device.info.sn success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_117">10.3 查询分享</h2>

<h3 id="toc_118">(1) 查询设备被分享过的好友列表</h3>

<div><pre><code class="language-none">【描述】
    查询单个设备被分享的好友列表

【函数调用】
    //查询单个设备被分享的好友列表
    @param type 设备类型
    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)getFriendListForDeviceWithDeviceType:(MeariDeviceType)type deviceID:(NSInteger)deviceID success:(MeariSuccess_FriendListForDevice)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getFriendListForDeviceWithDeviceType:MeariDeviceTypeIpc deviceID:self.deviceID success:^(NSArray&lt;MeariFriendInfo *&gt; *friends) {
    
    } failure:^(NSError *error) {
    
    }];</code></pre></div>

<h3 id="toc_119">(2) 查询某个好友的被分享设备列表</h3>

<div><pre><code class="language-none">【描述】
    查询某个好友是否有自己分享过的设备

【函数调用】
    //查询某个好友的被分享设备列表
    @param friendID 好友ID
    @param success 成功回调
    @param failure 失败回调
    - (void)getDeviceListForFriend:(NSInteger)friendID success:(MeariSuccess_DeviceListForFriend)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getDeviceListForFriend:self.model.info.userID success:^(NSArray&lt;MeariDevice *&gt; *devices) {

    } failure:^(NSError *error) {

    }];
</code></pre></div>

<h1 id="toc_120">11.消息中心</h1>

<div><pre><code class="language-none">所属：MeariMessageInfo</code></pre></div>

<div><pre><code class="language-none">注意：设备的报警消息，一经设备的主人拉取后，服务器就会删除该消息，因此需要本地保存，被分享的人拉取了设备的报警消息，服务器不会删除，这里注意主人和被分享人的区别</code></pre></div>

<h2 id="toc_121">11.1 获取所有设备是否有消息</h2>

<div><pre><code class="language-none">【描述】
    获取所有设备是否有消息
    所属：MeariMessageInfoAlarm

【函数调用】
    //获取所有设备是否有消息
    @param success 成功回调
    @param failure 失败回调
    - (void)getAlarmMessageList:(MeariSuccess_MsgAlarmList)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getAlarmMessageList:^(NSArray&lt;MeariMessageInfoAlarm *&gt; *msgs) {

    } failure:^(NSError *error) {

    }];
 【注意事项】
    如果消息一经主人拉取后，服务器不会保存消息，被分享的好友也看不到这些消息</code></pre></div>

<h2 id="toc_122">11.2 获取系统消息</h2>

<div><pre><code class="language-none">【描述】
    获取系统消息 
    所属：MeariMessageInfoSystem

【函数调用】
    //获取系统消息
    @param success 成功回调
    @param failure 失败回调
    - (void)getSystemMessageList:(MeariSuccess_MsgSystemList)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getSystemMessageList:^(NSArray&lt;MeariMessageInfoSystem *&gt; *msgs) {

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_123">11.3 获取某个设备报警消息</h2>

<div><pre><code class="language-none">【描述】
    获取某个设备报警消息
    所属：MeariMessageInfoAlarmDevice

【函数调用】
    //获取某个设备报警消息
    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)getAlarmMessageListForDevice:(NSInteger)deviceID success:(MeariSuccess_MsgAlarmDeviceList)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] getAlarmMessageListForDevice:_deviceID success:^(NSArray&lt;MeariMessageInfoAlarmDevice *&gt; *msgs, MeariDevice *device) {

    } failure:^(NSError *error) {

    }];
 【注意事项】
    如果消息一经主人拉取后，服务器不会保存消息，被分享的好友也看不到这些消息</code></pre></div>

<h2 id="toc_124">11.4 批量删除系统消息</h2>

<div><pre><code class="language-none">【描述】
    批量删除系统消息

【函数调用】
    //批量删除系统消息
    @param msgIDs 多个消息ID
    @param success 成功回调
    @param failure 失败回调
    - (void)deleteSystemMessages:(NSArray &lt;NSNumber *&gt;*)msgIDs success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] deleteSystemMessages:arr success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_125">11.5 批量删除多个设备报警消息</h2>

<div><pre><code class="language-none">【描述】
    批量删除多个设备报警消息

【函数调用】
    //批量删除多个设备报警消息
    @param deviceIDs 多个设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)deleteAlarmMessages:(NSArray &lt;NSNumber *&gt;*)deviceIDs success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] deleteAlarmMessages:arr success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_126">11.6 标记单个设备消息全部已读</h2>

<div><pre><code class="language-none">【描述】
    标记单个设备消息全部已读

【函数调用】
    //标记单个设备消息全部已读
    @param deviceID 设备ID
    @param success 成功回调
    @param failure 失败回调
    - (void)markDeviceAlarmMessage:(NSInteger)deviceID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    [[MeariUser sharedInstance] markDeviceAlarmMessage:_deviceID success:^{

    } failure:^(NSError *error) {

    }];</code></pre></div>

<h2 id="toc_127">11.7 好友消息处理</h2>

<div><pre><code class="language-none">【描述】
    好友消息处理-同意|拒绝

【函数调用】
    //同意添加好友
    @param friendID 好友ID
    @param msgID 消息ID
    @param success 成功回调
    @param failure 失败回调
    - (void)agreeAddFriend:(NSInteger)friendID msgID:(NSInteger)msgID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
    //拒绝添加好友
    @param friendID 好友ID
    @param msgID 消息ID
    @param success 成功回调
    @param failure 失败回调
    - (void)refuseAddFriend:(NSInteger)friendID msgID:(NSInteger)msgID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //同意添加好友
    [[MeariUser sharedInstance] agreeAddFriend:model.info.userID.integerValue msgID:model.info.msgID.integerValue success:^{

    } failure:^(NSError *error) {

    }];
    
    //拒绝添加好友
    [[MeariUser sharedInstance] refuseAddFriend:model.info.userID.integerValue msgID:model.info.msgID.integerValue success:^{
    
    } failure:^(NSError *error) {
    
    }];
【注意事项】
    如果消息处理完了，需要手动删除消息</code></pre></div>

<h2 id="toc_128">11.8 设备消息处理</h2>

<div><pre><code class="language-none">【描述】
    设备消息处理-同意|拒绝

【函数调用】
    //同意分享设备
    @param deviceID 设备ID
    @param friendID 好友ID
    @param msgID 消息ID
    @param success 成功回调
    @param failure 失败回调
    - (void)agreeShareDevice:(NSInteger)deviceID toFriend:(NSInteger)friendID msgID:(NSInteger)msgID success:(MeariSuccess)success failure:(MeariFailure)failure;
    
    //拒绝分享设备
    @param deviceID 设备ID
    @param friendID 好友ID
    @param msgID 消息ID
    @param success 成功回调
    @param failure 失败回调
    - (void)refuseShareDevice:(NSInteger)deviceID toFriend:(NSInteger)friendID msgID:(NSInteger)msgID success:(MeariSuccess)success failure:(MeariFailure)failure;

【代码范例】
    //同意分享设备
    [[MeariUser sharedInstance] agreeShareDevice:model.info.deviceID.integerValue toFriend:model.info.userID.integerValue msgID:model.info.msgID.integerValue success:^{

    } failure:^(NSError *error) {

    }];
    
    //拒绝分享设备
    [[MeariUser sharedInstance] refuseShareDevice:model.info.deviceID.integerValue toFriend:model.info.userID.integerValue msgID:model.info.msgID.integerValue success:^{
    
    } failure:^(NSError *error) {
    
    }];
【注意事项】
    如果消息处理完，需要手动删除消息</code></pre></div>




</body>

</html>
